
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Your Slot</title>

    <style>

        *
        {
            box-sizing: border-box;
            margin: 0px;
        }

        main
        {
            background-color: whitesmoke;
            min-height: 800px;
        }

        /*.searchBy
        {
            display: flex;
            justify-content: center;;
            margin: 50px 10px 10px 10px;
        }*/

        /*.searchByPin,.searchByDist
        {
            margin: 10px; 
            background-color: rgba(8, 143, 121, 0.616);
            border: 1px solid black;  
            border-radius: 5px;
            padding: 10px;
            font-weight: bold;
            color: rgb(53, 30, 30);
        }*/

        .searchBtn1,.searchBtn2
        {
            border: 1px solid black;
            background-color: rgba(0, 46, 44, 0.548);
            border-radius: 5px;
            padding: 10px;
            font-weight: bold;
            color: white;
        }
        
        input[type="number"]
        ,[type="text"]
        {
            width: 100%;
            margin: 10px 0px;
            padding: 5px;
            border-radius: 5px;
            border: rgba(28, 31, 26, 0.685) 3px solid;
        }

        p
        {
            margin: 40px 10px 80px 0px;
            text-align: center;
            font-family: cursive;
            font-size: large;
        }

        .pin
        {
            font-family: cursive;
            font-size: large;
        }

        button:hover
        {
            background-color: rgb(85, 142, 160);
            cursor: pointer;
        }
        
        
        table
        {
            width: 100%;
            padding: 20px;
            justify-content: space-between;
            text-align: center;
            color:rgba(0, 0, 0, 0.671);
            font-family: cursive;
        }

        th
        {
            margin: 50px;
            padding: 25px;
            border: 1px solid green;      
        }
        
        td
        {
            border: rgba(10, 83, 1, 0.336) 2px solid;
            color: rgb(0, 0, 0);
        }
        img
        {
            width: 100%;
        }

        .byPin
        {
            padding: 50px;
        }

    </style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>

        <header>
            <img src="https://www.cowin.gov.in/assets/images/largest-vaccine-banner.jpg">
        </header>

        <main>
            <div class="main-1">
            
                <!--
           <div class="searchBy">
                <button class="searchByPin" onclick="pin-1">Search By Pin</button>
               <button class="searchByDist" onclick="myFunction">Search By Distic</button></a>
            </div>

            <p>-->
            
            <div class="byPin">  
            <p> Check your nearest vaccination center and slots availability. </p>
            <div class="pin">Enter Your Pin :</div> 
            <input type="number" id="pin">
            <button class="searchBtn1" id="search">Search</button>
            </div>  

            <!--
            <div class="byDist">
            <div class="pin">Enter Your Distic :</div> 
            <input type="text" id="dist">
            <button class="searchBtn2" id="search">Search</button>
            </div>-->

            <table class="table" id="session">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Pin code</th>
                        <th>Date</th>
                        <th>18+</th>
                        <th>45+</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            
            </p>
        </div>
        </main>

        <script>


$('.searchByPin').on('click',
  function() {
    $('.byPin').show();
    $('.byDist').hide();
  }
);

$('.searchByDist').on('click',
  function() {
    $('.byPin').hide();
    $('.byDist').show();
  }
);



            var date = new Date();
            var today = date.getDate() + "-" + (date.getMonth() + 1) + "-" + date.getFullYear();
            $(".searchBtn1").click(function () {
                $("tbody").empty();
                var pin = $('#pin').val();
                if (pin == '' || pin == undefined) {
                    alert('please enter pin code');
                    return;
                }
                
                $.get("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByPin?pincode=" + pin +
                    "&date=" + today,
                    function (data, status) {
                        if (status) {
                            var sessions = data.sessions ? data.sessions : [];
                            if (sessions) {
                                for (var i = 0; i <= sessions.length; i++) {
                                    var classname = "info";
                                    if (i % 2 == 0) {
                                        classname = "success"
                                    }
                                    
                                    $('#session tbody').append("<tr class=" + classname + "><td>" + sessions[i]
                                        .name + "</td><td>" + sessions[i].pincode + "</td><td>" + sessions[i].date + "</td><td>" + sessions[i].available_capacity + "</td><td>" +
                                        sessions[i].available_capacity_dose1 + "</td></tr>")
                                }
                            }
                            else alert('No Record Found');
                        } else {
                            alert('error');
                        }
    
                    });
            });
    
            $(".searchBtn2").click(function () {
                $("tbody").empty();
                var district_id = "645";
                $.get("https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/findByDistrict?district_id=" +
                    district_id + "&date=" + today,
                    function (data, status) {
                        if (status) {
                            var sessions = data.sessions ? data.sessions : [];
                            if (sessions) {
                                for (var i = 0; i <= sessions.length; i++) {
                                    var classname = "info";
                                    if (i % 2 == 0) {
                                        classname = "success"
                                    }
    
                                    $('#session tbody').append("<tr class=" + classname + "><td>" + sessions[i]
                                        .name + "</td><td>" + sessions[i].pincode + "</td><td>" + sessions[i].date + "</td><td>" + sessions[i].available_capacity + "</td><td>" +
                                        sessions[i].available_capacity_dose1 + "</td></tr>")
                                }
                            }
                        } else {
                            alert('error');
                        }
                    });
            });
        </script>
</body>

</html>